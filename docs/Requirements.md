# 就業規則RAGチャットボット構築プロジェクト 要件定義書

## 1. プロジェクト目的
* 自宅環境（シングルホスト）にて、市区町村の公開データに基づいた就業規則チャットボットを構築する。
* RAG（検索拡張生成）の一連の構築工程（収集・加工・推論・評価）の実践経験を積む。

## 2. ターゲットデータ
* **対象自治体:** 山口県熊毛郡上関町（優先）、大阪府豊中市、または任意の公開自治体。
* **対象ドキュメント:** 就業規則、人事・給与・勤務時間等に関する条例・規則。
* **データ形式:** 各自治体の例規公開システム上のHTMLデータ。

## 3. システム構成（シングルホスト）
* **ハードウェア:** HP Z620（CPU: Xeon / RAM: 64GB / ストレージ: SSD推奨）。
* **GPU:** 現状は旧世代GTX1080以前（CPU推論メイン）、将来的にTesla P40への換装を考慮。
* **推論エンジン:** Ollama（標準モデルとして **Llama 3.1 8B** を使用）。
* **オーケストレーション:** Dify（Docker Composeベース）。
* **開発言語:** Python 3.10+（データ収集・加工用）。

## 4. 機能要件
### 4.1 データ収集・加工（Python）
* **スクレイピング機能:** 自治体例規システムから対象の条文を取得。
* **Markdown変換:** 「章・節・条」の階層構造を保持したままMarkdown形式へ変換。
* **定期更新:** 1週間ごとの自動（または半自動）更新フローの構築。

### 4.2 推論・生成（Llama 3.1 活用）
* **モデル選定:** 日本語対応と論理推論能力のバランスに優れた Llama 3.1 8B を採用。
* **出力制御:** * 常に日本語で回答すること。
    * 提供された条文コンテキストに基づかない回答（ハルシネーション）の厳格な抑制。
    * 根拠となる条文番号を必ず明記させるプロンプト設計。
* **性能目標:** * ローカル環境（CPU推論）でのレスポンス待機時間を実用圏内（30秒以内）に収める。
    * 将来的な GPU 環境移行時に、Llama 3.1 70B へのスケールアップが可能な設計とする。
    
### 4.3 RAGパイプライン（Dify）
* **ナレッジ構築:** 加工済みMarkdownのインポートとベクトル化。
* **検索ロジック:** ユーザーの質問に対し関連条文を抽出。
* **生成機能:** SLMを用いた自然な日本語回答。
* **出典の明示:** 回答の根拠となった条文番号およびソース情報の付与を必須とする。

## 5. 非機能要件
* **セキュリティ:** 完全ローカル環境（Localhost）内でのデータ完結。
* **保守性:** Pythonコードによる処理の自動化と再利用性の確保。
* **拡張性:** 将来的なGPU換装（Tesla P40）時に、最小限の設定変更で推論速度を向上できる構成。

## 6. 評価指標
* **精度測定:** * 正解データ（Q&Aペア）を30件程度自動生成。
    * 生成された回答を正解データと照合し、正答率を測定する。
* **根拠確認:** すべての回答において、正しい出典（条文）が明示されているかを検証する。